# Plan Format Reference

This document defines the expected format for `plan.md`, used by the **prospec-plan** Skill.

---

## Purpose

`plan.md` is the execution plan for a Story, describing the implementation overview, affected modules, implementation steps, and risk assessment.

---

## Standard Format

### 1. Overview

A 1-2 paragraph summary describing the overall implementation strategy:

```markdown
## Overview

[Paragraph 1: What problem this Story solves]

[Paragraph 2: The implementation strategy and key design decisions]
```

**Example:**

```markdown
## Overview

This story implements a unified error handling mechanism for {{project_name}}. Currently, errors are handled inconsistently across different modules, making debugging difficult.

We will create a centralized error handler module that defines standard error types, response formats, and logging strategies. This follows the error handling conventions specified in {{constitution_path}}.
```

---

### 2. Affected Modules

Use a table to list affected modules:

```markdown
## Affected Modules

| Module | Impact | Changes |
|--------|--------|---------|
| [module name] | [High/Medium/Low] | [Brief description of changes] |
```

**Example:**

```markdown
## Affected Modules

| Module | Impact | Changes |
|--------|--------|---------|
| error-handler | High | New module creation |
| api-middleware | Medium | Integrate centralized error handler |
| logger | Low | Add error-specific log formatting |
```

---

### 3. Implementation Steps

Use an ordered numbered list with details for each step:

```markdown
## Implementation Steps

1. **[Step title]**
   - [Detail 1]
   - [Detail 2]

2. **[Step title]**
   - [Detail 1]
   - [Detail 2]
```

**Example:**

```markdown
## Implementation Steps

1. **Create error-handler module**
   - Define standard error types (ValidationError, NotFoundError, etc.)
   - Implement error code mapping system
   - Create error response formatter

2. **Integrate with existing modules**
   - Update api-middleware to use centralized error handler
   - Refactor existing error handling code
   - Ensure backward compatibility

3. **Add logging and monitoring**
   - Integrate with logger module
   - Add error tracking hooks
   - Configure log levels per error type

4. **Update documentation**
   - Document error codes in {{knowledge_base_path}}
   - Add usage examples for developers
   - Update API documentation
```

---

### 4. Risk Assessment

Use a table to list risks, impacts, and mitigation strategies:

```markdown
## Risk Assessment

| Risk | Impact | Mitigation |
|------|--------|------------|
| [Risk description] | [High/Medium/Low] | [Mitigation strategy] |
```

**Example:**

```markdown
## Risk Assessment

| Risk | Impact | Mitigation |
|------|--------|------------|
| Breaking existing error handling | High | Implement gradual migration, maintain backward compatibility |
| Performance overhead | Low | Optimize error handler, benchmark critical paths |
| Incomplete error coverage | Medium | Conduct thorough code review, add integration tests |
```

---

## File Length Guidelines

- Keep under **120 lines**
- Ideal number of Implementation Steps: 4-8
- If steps exceed 10, consider splitting into multiple Stories

---

## Reference Information

- Project name: `{{project_name}}`
- AI Knowledge path: `{{knowledge_base_path}}`
- Constitution file: `{{constitution_path}}`
