# Knowledge Generate Format Reference

This document defines the output file format specifications for the `/prospec-knowledge-generate` Skill.

---

## 1. modules/{module}/README.md Format

### Required Sections

Each module README must include the following sections, using `prospec:auto-start/end` and `prospec:user-start/end` markers:

```markdown
# [Module Name]

> [One-sentence description of module responsibility]

<!-- prospec:auto-start -->
## Overview

[2-3 paragraphs describing:]
- The module's role and position in the system
- Core design principles
- Primary use cases

## Responsibilities

- [Responsibility 1: Specific description of what this module handles]
- [Responsibility 2]
- [Responsibility 3]

## Key Files

| File | Purpose |
|------|---------|
| `[relative path]` | [Specific purpose of this file] |
| `[relative path]` | [Specific purpose of this file] |

## Public Interface

### [Function/Class Name]

- **Signature**: `functionName(param: Type): ReturnType`
- **Purpose**: [Brief description]

### [Function/Class Name]

- **Signature**: `className.method(param: Type): ReturnType`
- **Purpose**: [Brief description]

## Dependencies

- **Depends on**: [List modules this module imports from]
- **Depended by**: [List modules that import from this module]

## Design Decisions

- **[Decision title]**: [What was chosen] — [Why this choice was made]
<!-- prospec:auto-end -->

<!-- prospec:user-start -->
<!-- Add manual notes, memos, TODOs here. This section will not be overwritten. -->
<!-- prospec:user-end -->
```

### Format Rules

1. **Module name**: Use directory name, e.g., `cli`, `services`, `lib`
2. **Responsibilities**: 3-7 items, each starting with a verb (e.g., "Handle", "Manage", "Provide")
3. **Key files**: List only main files (5-15), no need to list everything
4. **Public interface**: Only list exported functions/classes, not internal implementations
5. **Dependencies**: Use module names, not file paths

---

## 2. _index.md Module Table Format

### Table Structure

```markdown
## Modules

| Module | Keywords | Status | Description | Depends On |
|--------|----------|--------|-------------|------------|
| [name] | [keywords] | active | [description] | [dependencies] |
```

### Field Specifications

- **Module**: Module name, matching the directory name under `modules/`
- **Keywords**: 3-5 keywords, comma-separated, used for search and matching
- **Status**: `active` (in use), `deprecated` (phased out), `planned` (upcoming)
- **Description**: One-sentence description, max 50 words
- **Depends On**: Names of other depended-upon modules, use `—` if none

### Sorting Rules

Modules are sorted by architecture layer (bottom to top):
1. types / type definitions
2. lib / shared utilities
3. services / business logic
4. cli / command interface
5. templates / templates

---

## 3. _conventions.md Format

```markdown
# Coding Conventions

> {{project_name}} coding conventions and best practices

<!-- prospec:auto-start -->
## Naming Conventions

- **Files**: [Convention, e.g., kebab-case]
- **Variables/Functions**: [Convention, e.g., camelCase]
- **Classes/Interfaces**: [Convention, e.g., PascalCase]
- **Constants**: [Convention, e.g., UPPER_SNAKE_CASE]

## Project Patterns

### [Pattern name, e.g., Error Handling]
[Describe how this project handles this pattern]

### [Pattern name, e.g., Logging]
[Description]

## Import Ordering

1. Node.js built-in modules
2. Third-party packages
3. Project internal modules (absolute paths)
4. Relative path modules

## Testing Conventions

- Test file location: [e.g., tests/unit/]
- Naming format: [e.g., *.test.ts]
- Testing framework: [e.g., vitest]
<!-- prospec:auto-end -->

<!-- prospec:user-start -->
<!-- Add team-specific conventions, exceptions, etc. here -->
<!-- prospec:user-end -->
```

---

## 4. Re-run Safety Rules

| Operation | prospec:auto-start/end | prospec:user-start/end |
|-----------|----------------------|----------------------|
| First generation | Populate content | Leave empty (with comment prompt) |
| Re-run generation | Overwrite and update | Preserve as-is |

**Implementation**: Read existing file → Extract `prospec:user-start/end` content → Regenerate `prospec:auto-start/end` → Merge and write back.
