# Tasks 格式參考

本文件說明 `tasks.md` 的預期格式，供 **prospec-tasks** Skill 參考。

---

## 檔案用途

`tasks.md` 將 `plan.md` 的實作步驟分解為具體的開發任務，並提供複雜度估計和依賴關係標記。

---

## 標準格式

### 1. Checkbox 格式

使用 Markdown checkbox 語法：

```markdown
- [ ] 待完成的任務
- [x] 已完成的任務
```

---

### 2. Architecture-Layer 分組

依照架構層次分組任務，建議順序：

```markdown
## Types

- [ ] [任務描述] ~{lines} lines

## Lib

- [ ] [任務描述] ~{lines} lines

## Services

- [ ] [任務描述] ~{lines} lines

## CLI

- [ ] [任務描述] ~{lines} lines

## Tests

- [ ] [任務描述] ~{lines} lines
```

**範例：**

```markdown
## Types

- [ ] Define ErrorType enum (ValidationError, NotFoundError, etc.) ~30 lines
- [ ] Create ErrorResponse interface for API responses ~20 lines

## Lib

- [ ] [P] Implement BaseError class with error code mapping ~50 lines
- [ ] [P] Implement ErrorFormatter utility ~40 lines
- [ ] Create error factory functions (createValidationError, etc.) ~60 lines

## Services

- [ ] Integrate error handler with API middleware ~80 lines
- [ ] Update existing error handling in UserService ~40 lines
- [ ] Update existing error handling in AuthService ~40 lines

## CLI

- [ ] Add error code reference to CLI help command ~20 lines

## Tests

- [ ] [P] Write unit tests for BaseError class ~60 lines
- [ ] [P] Write unit tests for ErrorFormatter ~50 lines
- [ ] Write integration tests for API error responses ~100 lines
```

---

### 3. Parallelizable Tasks 標記

使用 `[P]` 標記可平行執行的任務（無依賴關係）：

```markdown
- [ ] [P] 可以平行執行的任務 1 ~50 lines
- [ ] [P] 可以平行執行的任務 2 ~50 lines
```

---

### 4. Complexity Estimate 格式

使用 `~{lines} lines` 格式估計複雜度：

```markdown
- [ ] 簡單任務 ~20 lines
- [ ] 中等任務 ~50 lines
- [ ] 複雜任務 ~100 lines
```

---

### 5. Summary Section

在檔案末尾加上摘要：

```markdown
## Summary

- **Total Tasks:** {總任務數}
- **Parallelizable Tasks:** {可平行執行的任務數}
- **Total Estimated Lines:** ~{總預估行數} lines
```

**範例：**

```markdown
## Summary

- **Total Tasks:** 13
- **Parallelizable Tasks:** 4
- **Total Estimated Lines:** ~640 lines
```

---

## Task Granularity 指引

- **理想數量：15-25 個任務**
- **太多（>25）：** 考慮合併相似任務
- **太少（<10）：** 考慮拆分複雜任務

---

## 任務粒度範例

### 良好的粒度：

```markdown
- [ ] Implement BaseError class with error code mapping ~50 lines
```

### 粒度太大（需拆分）：

```markdown
- [ ] Implement entire error handling system ~500 lines
```

**拆分為：**

```markdown
- [ ] Implement BaseError class ~50 lines
- [ ] Implement ErrorFormatter utility ~40 lines
- [ ] Implement error factory functions ~60 lines
- [ ] Integrate with API middleware ~80 lines
```

### 粒度太小（需合併）：

```markdown
- [ ] Import BaseError class ~1 line
- [ ] Define error code constant ~1 line
- [ ] Define error message constant ~1 line
```

**合併為：**

```markdown
- [ ] Define error codes and messages ~30 lines
```

---

## 檔案長度建議

- 保持在 **100 行以內**
- 如果任務過多（>30），考慮 Story 範圍是否過大

---

## 參考資訊

- 專案名稱: `{{project_name}}`
- AI Knowledge 路徑: `{{knowledge_base_path}}`
- Constitution 檔案: `{{constitution_path}}`
