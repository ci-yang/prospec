# AI Knowledge Format Reference

This document describes the AI Knowledge format and usage patterns, referenced by all Skills.

---

## AI Knowledge Structure

```
{{knowledge_base_path}}/
├── _index.md                    # Overview: module list and keyword index
└── modules/
    ├── {module-1}/
    │   └── README.md            # Module detailed documentation
    ├── {module-2}/
    │   └── README.md
    └── {module-3}/
        └── README.md
```

---

## 1. `_index.md` Format

### Purpose

Provides a module overview and keyword index for the project, enabling quick identification of relevant modules.

### Standard Format

```markdown
# {{project_name}} - AI Knowledge Index

## Modules

| Module | Keywords | Status | Description | Depends On |
|--------|----------|--------|-------------|------------|
| [module-1] | keyword1, keyword2 | Active | [Brief description] | - |
| [module-2] | keyword3, keyword4 | Active | [Brief description] | module-1 |
| [module-3] | keyword5, keyword6 | Deprecated | [Brief description] | module-1, module-2 |
```

### Field Descriptions

- **Module:** Module name (links to corresponding README.md)
- **Keywords:** Tags for keyword matching (comma-separated)
- **Status:** Module status (Active, Deprecated, Planned)
- **Description:** Brief description of module functionality
- **Depends On:** Other modules this depends on (comma-separated)

---

## 2. `modules/{module}/README.md` Format

### Purpose

Provides detailed documentation for a single module, including overview, file listing, API, and internal notes.

### Standard Format

```markdown
# Module: {module-name}

## Overview

[1-2 paragraphs describing the module's functionality, purpose, and design principles]

---

## Key Files

- **src/{module}/index.ts**: [File purpose]
- **src/{module}/core.ts**: [File purpose]
- **src/{module}/utils.ts**: [File purpose]

---

## Public API

### Function: functionName(param1, param2)

**Description:** [Functionality description]

**Parameters:**
- `param1` (Type): [Parameter description]
- `param2` (Type): [Parameter description]

**Returns:** (Type) [Return value description]

**Example:**
```{{tech_stack.language}}
// Usage example
const result = functionName(value1, value2);
```

---

### Class: ClassName

**Description:** [Class description]

**Methods:**
- `method1(param)`: [Method description]
- `method2(param)`: [Method description]

**Example:**
```{{tech_stack.language}}
// Usage example
const instance = new ClassName();
instance.method1(value);
```

---

## Internal Notes

### Design Decisions

- [Design decision 1]
- [Design decision 2]

### Known Issues

- [Known issue 1]
- [Known issue 2]

### Future Improvements

- [Future improvement 1]
- [Future improvement 2]
```

---

## 3. Content Markers

AI Knowledge uses special markers to distinguish auto-generated and manually maintained content:

### Auto-Generated Content

```markdown
<!-- prospec:auto-start -->
[Auto-generated content, will be overwritten by tools]
<!-- prospec:auto-end -->
```

### User-Maintained Content

```markdown
<!-- prospec:user-start -->
[User manually maintained content, will not be overwritten by tools]
<!-- prospec:user-end -->
```

---

## 4. Progressive Disclosure Usage

**Load AI Knowledge progressively — avoid loading all files at once:**

### Step 1: Read _index.md

Before starting any Story or task, read `{{knowledge_base_path}}/_index.md`:

- Understand the project's overall architecture
- Quickly locate relevant modules via keyword matching
- Confirm module dependency relationships

### Step 2: Load Module READMEs On Demand

Only load the README for the module relevant to the current task:

- When working on `error-handler` tasks, read `{{knowledge_base_path}}/modules/error-handler/README.md`
- When working on `api-middleware` tasks, read `{{knowledge_base_path}}/modules/api-middleware/README.md`

### Step 3: Avoid Over-Loading

**Do not read all module READMEs at once**, as this causes:
- Context overload (token waste)
- Judgment interference (irrelevant information)

---

## Example Usage Flow

### Scenario: Implementing a "Unified Error Handling" Story

1. **Read _index.md:**
   - Discover relevant modules: `error-handler`, `api-middleware`, `logger`

2. **Execute Tasks:**
   - Task 1: Implement `BaseError` → Read `{{knowledge_base_path}}/modules/error-handler/README.md`
   - Task 2: Integrate API Middleware → Read `{{knowledge_base_path}}/modules/api-middleware/README.md`
   - Task 3: Update Logger → Read `{{knowledge_base_path}}/modules/logger/README.md`

3. **Avoid:**
   - Reading all module READMEs at once (causes context overload)

---

## Reference Information

- Project name: `{{project_name}}`
- Tech stack: `{{tech_stack.language}}` + `{{tech_stack.framework}}`
- AI Knowledge path: `{{knowledge_base_path}}`
- Constitution file: `{{constitution_path}}`
