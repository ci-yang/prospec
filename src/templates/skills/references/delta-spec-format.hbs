# Delta Spec Format Reference

This document defines the expected format for `delta-spec.md`, used by the **prospec-plan** Skill.

---

## Purpose

`delta-spec.md` describes requirement deltas using ADDED/MODIFIED/REMOVED categories to track requirement evolution.

---

## REQ ID Naming Convention

```
REQ-{MODULE}-{NUMBER}
```

- `{MODULE}`: Module name in uppercase, hyphen-separated (e.g., `AUTH`, `API-MIDDLEWARE`, `ERROR-HANDLER`)
- `{NUMBER}`: Three-digit sequential number (e.g., `001`, `002`, `003`)

**Examples:**
- `REQ-AUTH-001`
- `REQ-API-MIDDLEWARE-001`
- `REQ-ERROR-HANDLER-002`

---

## Standard Format

### 1. ADDED - New Requirements

New requirements with full details:

```markdown
## ADDED

### REQ-{MODULE}-{NUMBER}: [Requirement title]

**Description:**
[Detailed description of the requirement]

**Acceptance Criteria:**
1. [Specific verifiable condition 1]
2. [Specific verifiable condition 2]
3. [Specific verifiable condition 3]

**Priority:** [High/Medium/Low]

---
```

**Example:**

```markdown
## ADDED

### REQ-ERROR-HANDLER-001: Centralized Error Types

**Description:**
Define a set of standard error types that can be used across all modules in {{project_name}}. Each error type should have a unique error code and HTTP status mapping.

**Acceptance Criteria:**
1. Error types include ValidationError, NotFoundError, UnauthorizedError, ServerError
2. Each error type has a unique error code following the convention in {{constitution_path}}
3. Error codes map to appropriate HTTP status codes (400, 401, 404, 500, etc.)

**Priority:** High

---

### REQ-ERROR-HANDLER-002: Error Response Formatter

**Description:**
Implement a formatter that converts errors into standardized JSON responses for API endpoints.

**Acceptance Criteria:**
1. Response includes error code, message, and timestamp
2. Stack traces are excluded from production responses
3. Supports localization for error messages

**Priority:** Medium

---
```

---

### 2. MODIFIED - Changed Requirements

Modified requirements showing before/after comparison:

```markdown
## MODIFIED

### REQ-{MODULE}-{NUMBER}: [Requirement title]

**Before:**
[Original requirement description or condition]

**After:**
[Updated requirement description or condition]

**Reason:**
[Why this modification was needed]

**Priority:** [High/Medium/Low]

---
```

**Example:**

```markdown
## MODIFIED

### REQ-API-MIDDLEWARE-003: Error Logging

**Before:**
Log all errors to console with full stack traces.

**After:**
Log errors to the logger module with configurable log levels. Stack traces are only logged in development mode.

**Reason:**
Align with the logging strategy defined in {{constitution_path}} and improve production security.

**Priority:** Medium

---
```

---

### 3. REMOVED - Removed Requirements

Removed requirements with rationale:

```markdown
## REMOVED

### REQ-{MODULE}-{NUMBER}: [Requirement title]

**Reason:**
[Why this requirement was removed]

---
```

**Example:**

```markdown
## REMOVED

### REQ-ERROR-HANDLER-004: Email Notification on Errors

**Reason:**
Out of scope for this story. Email notification will be handled by a separate monitoring module in a future story.

---
```

---

## File Length Guidelines

- Keep under **100 lines**
- If deltas exceed 10 requirements, consider splitting into multiple Stories

---

## Reference Information

- Project name: `{{project_name}}`
- AI Knowledge path: `{{knowledge_base_path}}`
- Constitution file: `{{constitution_path}}`
