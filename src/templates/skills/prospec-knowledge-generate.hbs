---
name: prospec-knowledge-generate
description: "Generate AI Knowledge | 生成 AI Knowledge - Read raw-scan.md, analyze project structure, autonomously decide module boundaries, and produce module READMEs and index. Triggers: knowledge, generate knowledge, analyze project, module split, 生成知識, 分析專案, 模組切割"
---

# Prospec Knowledge Generate Skill

## Activation

When triggered, briefly describe in the user's language:
- That you'll read raw-scan.md to understand the project structure
- You'll autonomously decide module boundaries based on project type
- You'll generate module READMEs, _index.md, and _conventions.md

## Startup Loading

1. Read `{{knowledge_base_path}}/raw-scan.md` — **must exist**, otherwise stop and prompt `prospec knowledge init`
2. Read `{{knowledge_base_path}}/_index.md` — if exists
3. Read `{{knowledge_base_path}}/_conventions.md` — if exists
4. Read `{{constitution_path}}` — if exists

## Prerequisite

Run `prospec knowledge init` first to generate `raw-scan.md` and empty scaffolding.

## Core Workflow

### Step 1: Analyze Project Type

Identify project type from raw-scan.md:

| Indicator | CLI Tool | Backend API | SPA Frontend | Monorepo |
|-----------|----------|-------------|--------------|----------|
| Entry | bin/, CLI entry | server.ts, app.ts | main.ts, App.tsx | packages/ |
| Dirs | commands/, cli/ | routes/, controllers/ | components/, pages/ | packages/, apps/ |
| Framework | commander, yargs | express, fastify | react, vue | turborepo, nx |

The table is a reference only — actual splitting should follow the project's real structure.

### Step 2: Decide Module Boundaries

Based on project type and actual directory structure. Merge small directories or split large ones as needed.

### Step 3: Create modules/*/README.md

Each README.md contains: overview, responsibilities, key files table, public interfaces, dependencies, design decisions.

**Re-run safety:**
- `prospec:auto-start/end` — overwritten on each run
- `prospec:user-start/end` — always preserved, never overwritten

### Step 4: Populate _index.md

Fill module table within `prospec:auto-start/end` markers (Module, Keywords, Status, Description, Depends On).

### Step 5: Populate _conventions.md

Naming conventions, project-specific patterns, directory conventions, import ordering rules.

### Step 6: Quality Check

- Each module has clear responsibility boundaries
- No circular dependencies between modules
- _index.md lists all modules
- All `prospec:user-start/end` content preserved

## NEVER

- **NEVER** overwrite content between `prospec:user-start/end` markers — these are user notes, always preserve
- **NEVER** start without raw-scan.md — prompt user to run `prospec knowledge init` first
- **NEVER** create circular module dependencies — module dependency graph must be a DAG
- **NEVER** put all files in a single module — even small projects need 2-3 responsibility modules minimum
- **NEVER** ignore Tech Stack info from raw-scan.md — it affects module splitting strategy
- **NEVER** write outdated file paths in READMEs — all paths must come from raw-scan.md real data

## Error Handling

| Scenario | Action |
|----------|--------|
| raw-scan.md missing | Stop, prompt `prospec knowledge init` |
| raw-scan.md incomplete | List missing sections, suggest re-running init or manual completion |
| Module README already exists | Only overwrite auto sections, preserve user sections |

All generated files must be written in English.
